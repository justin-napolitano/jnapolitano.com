

<!DOCTYPE html>
<html lang="en-us">
<head><meta charset="UTF-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="robots" content="index, follow">
<meta name="revisit-after" content="15 days"><link rel="author" href="/jnapolitano.com/humans.txt">
<link rel="apple-touch-icon" sizes="180x180" href="/jnapolitano.com/apple-touch-icon.png"><link rel="icon" href="/jnapolitano.com/favicon.ico" type="image/x-icon"><link rel="icon" type="image/png" sizes="32x32" href="/jnapolitano.com/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/jnapolitano.com/favicon-16x16.png">
<link rel="manifest" href="/jnapolitano.com/site.webmanifest">
<meta name="msapplication-TileImage" content="/jnapolitano.com/mstile-144x144.png">
<meta name="theme-color" content="#494f5c">
<meta name="msapplication-TileColor" content="#494f5c">
<link rel="mask-icon" href="/jnapolitano.com/safari-pinned-tab.svg" color="#494f5c"><meta name="author" content="Justin Napolitano"><meta name="description" content="Fact checking reported methane emissions proposed by the UN and Climate TRACE">
<meta itemprop="name" content="Rice Paddy Methane Emissions Estimation: Part 1">
<meta itemprop="description" content="Fact checking reported methane emissions proposed by the UN and Climate TRACE"><meta itemprop="datePublished" content="2022-05-21T08:30:32+00:00" />
<meta itemprop="dateModified" content="2024-07-15T13:14:28-05:00" />
<meta itemprop="wordCount" content="1854"><meta itemprop="image" content="jnapolitano.com/featured-rice-paddies.jpeg">
<meta itemprop="keywords" content="data,university-of-malaysia,climate-change,emissions," /><meta property="og:title" content="Rice Paddy Methane Emissions Estimation: Part 1" />
<meta property="og:description" content="Fact checking reported methane emissions proposed by the UN and Climate TRACE" />
<meta property="og:type" content="article" />
<meta property="og:url" content="jnapolitano.com/posts/rice-paddy-emissions-1/" /><meta property="og:image" content="jnapolitano.com/featured-rice-paddies.jpeg" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-05-21T08:30:32+00:00" />
<meta property="article:modified_time" content="2024-07-15T13:14:28-05:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="jnapolitano.com/featured-rice-paddies.jpeg"/>

<meta name="twitter:title" content="Rice Paddy Methane Emissions Estimation: Part 1"/>
<meta name="twitter:description" content="Fact checking reported methane emissions proposed by the UN and Climate TRACE"/>
<title>Rice Paddy Methane Emissions Estimation: Part 1</title>
<link rel="stylesheet dns-prefetch preconnect preload prefetch" as="style" href="/jnapolitano.com/css/style.min.e0b1c1b8d997f495fcb6256067ff9553b62e50837603056ab2905cd59b0b5e73.css" integrity="sha256-4LHBuNmX9JX8tiVgZ/+VU7YuUIN2AwVqspBc1ZsLXnM=" crossorigin="anonymous">
	<style>.bg-img {background-image: url('jnapolitano.com/featured-rice-paddies.jpeg');}</style></head>
<body id="page">
	<header id="site-header" class="animated slideInUp">
		<div class="hdr-wrapper section-inner">
			<div class="hdr-left">
				<div class="site-branding">
					<a href="jnapolitano.com">Justin Napolitano</a>
				</div>
				<nav class="site-nav hide-in-mobile"><a href="jnapolitano.com/posts/">POSTS</a><a href="https://jnapolitano.com/en/categories/projects/">PROJECTS</a><a href="https://jnapolitano.com/en/categories/adventures/">ADVENTURES</a><a href="https://jnapolitano.com/resume.pdf">RESUME</a></nav>
			</div>
			<div class="hdr-right hdr-icons">
				<button id="img-btn" class="hdr-btn" title=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-image"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><polyline points="21 15 16 10 5 21"></polyline></svg></button><span class="hdr-social hide-in-mobile"><a href="https://github.com/justin-napolitano" target="_blank" rel="noopener me" title="Github"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a><a href="https://www.linkedin.com/in/justin-napolitano/" target="_blank" rel="noopener me" title="Linkedin"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg></a><a href="mailto:personal.jnapolitano@gmail.com" target="_blank" rel="noopener me" title="Email"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg></a><a href="https://instagram.com/jay_burdie" target="_blank" rel="noopener me" title="Instagram"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path><line x1="17.5" y1="6.5" x2="17.5" y2="6.5"></line></svg></a><a href="https://mastodon.social/@jnapolitano" target="_blank" rel="noopener me" title="Mastodon"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m 21.474,13.998 c -0.296,1.526 -2.655,3.194 -5.365,3.519 -1.413,0.168 -2.804,0.323 -4.287,0.255 -2.426,-0.111 -4.34,-0.579 -4.34,-0.579 0,0.236 0.015,0.461 0.044,0.672 0.316,2.394 2.373,2.537 4.323,2.604 1.968,0.067 3.721,-0.486 3.721,-0.486 l 0.081,1.779 c 0,0 -1.377,0.739 -3.829,0.875 -1.352,0.075 -3.031,-0.034 -4.987,-0.551 C 2.594,20.963 1.865,16.442 1.752,11.855 1.719,10.493 1.741,9.209 1.741,8.134 1.741,3.443 4.814,2.069 4.814,2.069 6.363,1.356 9.022,1.056 11.787,1.035 h 0.067 c 2.764,0.022 5.426,0.322 6.975,1.033 0,0 3.073,1.375 3.073,6.066 0,0 0.039,3.461 -0.428,5.864"/><path d="M 6.464,13.231 V 7.973 c 0,-1.002 0.549,-2.613 2.613,-2.613 2.064,0 2.741,1.793 2.741,3.484 0,1.692 0,2.23 0,2.23"/><path d="M 17.173,13.231 V 7.973 c 0,-1.002 -0.549,-2.613 -2.613,-2.613 -2.064,0 -2.741,1.793 -2.741,3.484 0,1.692 -0,2.23 -0,2.23"/></svg></a><a href="https://x.com/jayburdybird" target="_blank" rel="noopener me" title="X"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path class="st0" d="m21.3 21.1 -11.4 -18.2h-7.2l11.4 18.2zm-18.6 0 7.2 -6.6m4.2 -5 7.2 -6.6"/></svg></a></span><button id="share-btn" class="hdr-btn" title=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-share-2"><circle cx="18" cy="5" r="3"></circle><circle cx="6" cy="12" r="3"></circle><circle cx="18" cy="19" r="3"></circle><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line></svg></button>
 
<div id="share-links" class="animated fast">
    
    
    
    
    <ul>
        <li>
            <a href="https://twitter.com/intent/tweet?hashtags=hermit2&amp;url=jnapolitano.com%2fposts%2frice-paddy-emissions-1%2f&amp;text=Rice%20Paddy%20Methane%20Emissions%20Estimation%3a%20Part%201" target="_blank" rel="noopener" aria-label="Share on X"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path class="st0" d="m21.3 21.1 -11.4 -18.2h-7.2l11.4 18.2zm-18.6 0 7.2 -6.6m4.2 -5 7.2 -6.6"/></svg></a>
        </li>
        <li>
            <a href="https://facebook.com/sharer/sharer.php?u=jnapolitano.com%2fposts%2frice-paddy-emissions-1%2f" target="_blank" rel="noopener" aria-label="Share on Facebook"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg></a>
        </li>
        <li>
            <a href="mailto:?subject=Rice%20Paddy%20Methane%20Emissions%20Estimation%3a%20Part%201&amp;body=jnapolitano.com%2fposts%2frice-paddy-emissions-1%2f" target="_self" rel="noopener" aria-label="Share on Email"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg></a>
        </li>
        <li>
            <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=jnapolitano.com%2fposts%2frice-paddy-emissions-1%2f&amp;source=jnapolitano.com&amp;title=Rice%20Paddy%20Methane%20Emissions%20Estimation%3a%20Part%201&amp;summary=Rice%20Paddy%20Methane%20Emissions%20Estimation%3a%20Part%201%2c%20by%20Justin%20Napolitano%0a%0aFact%20checking%20reported%20methane%20emissions%20proposed%20by%20the%20UN%20and%20Climate%20TRACE%0a" target="_blank" rel="noopener" aria-label="Share on LinkedIn"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg></a>
        </li>
        <li>
            <a href="#" onclick="linkShare(&#34;Rice Paddy Methane Emissions Estimation: Part 1&#34;,&#34;jnapolitano.com/posts/rice-paddy-emissions-1/&#34;,&#34;Rice Paddy Methane Emissions Estimation: Part 1, by Justin Napolitano\n\nFact checking reported methane emissions proposed by the UN and Climate TRACE\n&#34;); return false;" target="_self" rel="noopener" aria-label="Copy Link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-copy"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg></a>
        </li>
    </ul>
</div><button id="menu-btn" class="hdr-btn" title=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button>
			</div>
		</div>
	</header>
	<div id="mobile-menu" class="animated fast">
		<ul>
			<li><a href="jnapolitano.com/posts/">POSTS</a></li>
			<li><a href="https://jnapolitano.com/en/categories/projects/">PROJECTS</a></li>
			<li><a href="https://jnapolitano.com/en/categories/adventures/">ADVENTURES</a></li>
			<li><a href="https://jnapolitano.com/resume.pdf">RESUME</a></li>
		</ul>
	</div>


	<div class="bg-img"></div>
	<main class="site-main section-inner animated fadeIn faster"><article class="thin">
			<header class="post-header">
				<div class="post-meta"><span>May 21, 2022</span></div>
				<h1>Rice Paddy Methane Emissions Estimation: Part 1</h1>
			</header>
			<div class="post-info"><p>Fact checking reported methane emissions proposed by the UN and Climate TRACE</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-feather"><path d="M20.24 12.24a6 6 0 0 0-8.49-8.49L5 10.5V19h8.5z"></path><line x1="16" y1="8" x2="2" y2="22"></line><line x1="17.5" y1="15" x2="9" y2="15"></line></svg><a href="" target="_blank">Justin Napolitano</a></p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="jnapolitano.com/tags/data">data</a></span><span class="tag"><a href="jnapolitano.com/tags/university-of-malaysia">university-of-malaysia</a></span><span class="tag"><a href="jnapolitano.com/tags/climate-change">climate-change</a></span><span class="tag"><a href="jnapolitano.com/tags/emissions">emissions</a></span></p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg><span class="category"><a href="jnapolitano.com/categories/projects">projects</a></span></p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
    
    
    
    
    8 Minutes, 25 Seconds</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2022-05-21 03:30 -0500</p></div>
			<hr class="post-end">
			<div class="content">
				<h1 id="methane-emissions-estimation-data-part-1-a-comparison-between-faostat-and-university-of-malaysia-estimates">Methane Emissions Estimation Data Part 1: A Comparison between FAOSTAT and University of Malaysia Estimates<a href="#methane-emissions-estimation-data-part-1-a-comparison-between-faostat-and-university-of-malaysia-estimates" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h1>
<p>This post documents the data exploration phase of a project that determines whether global methane emissions produced by rice paddies are undercounted.</p>
<p>It is fairly code python and pandas heavy.</p>
<p>The code and data exploration follows the summary below.</p>
<h2 id="inspiration-for-this-work">Inspiration for this work<a href="#inspiration-for-this-work" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>The University of Malaysia in partnership with Climate TRACE release a paper stating that the UN undercounts rice paddy methane emissions by about 16%.  Upon review of their claims, I decided to test the data myself across a 5 year distribution to verify that the claims hold up across multiple distributions.</p>
<h3 id="university-of-malaysia-methodological-deficiencies">University of Malaysia Methodological Deficiencies<a href="#university-of-malaysia-methodological-deficiencies" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<ul>
<li>Comparing a 2019 distribution FAOSTAT to a 2020 distribution.</li>
<li>Rounding to 4 signficant figures.</li>
<li>Testing only one year of emissions data.</li>
<li>Did not publish data to hypothesis testing to determine if emission distributions significantly vary annually and between states.</li>
<li>Relying only on satellite data may undercount hectares in cultivation at higher altitudes.</li>
</ul>
<h3 id="faostat-methodological-deficiencies">FaoStat Methodological Deficiencies<a href="#faostat-methodological-deficiencies" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<ul>
<li>Relies upon official government statistics which can be manipulated at any point along the bureaucratic paper chain.</li>
<li>There is an incentive for certain nations to reduce their counts in order to receive international aid and to meet emissions standards.</li>
</ul>
<h3 id="university-of-malaysia-acknowledging-deficiencies-like-all-good-papers-should">University of Malaysia acknowledging deficiencies (like all good papers should)<a href="#university-of-malaysia-acknowledging-deficiencies-like-all-good-papers-should" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<p>&ldquo;The difference between harvested rice cultivation area from statistical data and remote-sensing estimates can be due to two factors: (i) MODIS data which have moderate spatial resolution lead to mixed pixels, where rice fields and non-rice fields are combined. This can overestimate area, especially in lowland regions and have a low ability to detect small rice field patches in upland regions (Frolking et al 1999, Seto et al 2000); and (ii) political and policy factors (Yan et al., 2019) such as determination of the amount of subsidies for fertilizers and evaluation of achievement of government programs in the agricultural sector. Other factors that contribute to discrepancy in CH4 emission are from different emission and scale factors that are related to water regime and organic amendment. These values give high uncertainty since the availability of these data are limited and quite variable.&rdquo;</p>
<h2 id="my-initial-impressions-and-findings">My Initial Impressions and findings<a href="#my-initial-impressions-and-findings" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<h3 id="initial">Initial<a href="#initial" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<p>The percent difference and the tonnage difference do not support each other.  I need to recalculate the totals section to ensure that we are doing things correctly.</p>
<p>I need to confirm the values, but I&rsquo;m initially impressed by the fact that the FAOSTAT data reports higher values than the Malaysia data on average.  According to the included paper this should not be the case.</p>
<h3 id="verified">Verified<a href="#verified" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<p>I calculated differences totals and means per DataFrame to ensure accuracy prior to the join.  I also dropped pre-calcuated values when joining to ensure that the aggregation algorithms to not modify the results.</p>
<p>The data is now consistent and supports the findings of the University of Malaysia Paper.  With that said it is important to note that the differences recorded are far smaller than suggested.</p>
<h2 id="import-dependencies">Import Dependencies<a href="#import-dependencies" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">folium</span>
<span class="kn">import</span> <span class="nn">contextily</span> <span class="k">as</span> <span class="nn">cx</span>
<span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">Point</span><span class="p">,</span> <span class="n">LineString</span><span class="p">,</span> <span class="n">Polygon</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.spatial</span> <span class="kn">import</span> <span class="n">cKDTree</span>
<span class="kn">from</span> <span class="nn">geopy.distance</span> <span class="kn">import</span> <span class="n">distance</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>

</code></pre></div><h3 id="dependencies">Dependencies<a href="#dependencies" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<ul>
<li>Geopandas</li>
<li>pandas</li>
<li>openpyxl</li>
<li>Shapely</li>
<li>geopy Distance</li>
<li>numpy</li>
</ul>
<h2 id="exploration-plan">Exploration Plan<a href="#exploration-plan" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<h3 id="data-imports">Data Imports<a href="#data-imports" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<ul>
<li>/Users/jnapolitano/Projects/wattime-takehome/data/ch4_2015-2021.xlsx</li>
<li>/Users/jnapolitano/Projects/wattime-takehome/data/emissions_csv_fao_emiss_csv_ch4_fao_2015_2019_tonnes.xlsx</li>
</ul>
<h3 id="import-data-frames">Import Data Frames<a href="#import-data-frames" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<p>Since jupyter caches the data to the notebook json I can import the dataframes that I will be using together.</p>
<p>If I were to build automated scripts to perform the analysis I would only load the data necessary to perform a process.</p>
<h3 id="experiment-with-plots-for-each-set">Experiment with Plots for each Set<a href="#experiment-with-plots-for-each-set" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<p>I don&rsquo;t know exactly which plots I want to include in the final report.</p>
<p>I &rsquo;ll plot a few for each data set</p>
<h3 id="calculate-differences-between-the-datasets">Calculate differences between the datasets<a href="#calculate-differences-between-the-datasets" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<ul>
<li>create a differences data frame</li>
<li>write to file for use</li>
<li>plot</li>
</ul>
<h2 id="university-of-malaysia-emission-estimates">University of Malaysia Emission Estimates<a href="#university-of-malaysia-emission-estimates" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">filepath</span> <span class="o">=</span> <span class="s2">&#34;/Users/jnapolitano/Projects/wattime-takehome/wattime-takehome/data/ch4_2015-2021.xlsx&#34;</span>

<span class="n">malaysia_emissions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
</code></pre></div><h3 id="print-df-head">Print Df Head<a href="#print-df-head" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">malaysia_emissions_df</span>
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<h3 id="calculate-co2-equivalency">Calculate Co2 Equivalency<a href="#calculate-co2-equivalency" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">malaysia_emissions_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2015&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">malaysia_emissions_df</span><span class="p">[</span><span class="s1">&#39;tCH4_2015&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">malaysia_emissions_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2016&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">malaysia_emissions_df</span><span class="p">[</span><span class="s1">&#39;tCH4_2016&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">malaysia_emissions_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2017&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">malaysia_emissions_df</span><span class="p">[</span><span class="s1">&#39;tCH4_2017&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">malaysia_emissions_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2018&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">malaysia_emissions_df</span><span class="p">[</span><span class="s1">&#39;tCH4_2018&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">malaysia_emissions_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2019&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">malaysia_emissions_df</span><span class="p">[</span><span class="s1">&#39;tCH4_2019&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">25</span><span class="p">)</span>
</code></pre></div><h3 id="calculate-means">Calculate Means<a href="#calculate-means" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">malaysia_emissions_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">malaysia_emissions_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">malaysia_emissions_df</span><span class="p">[</span><span class="s1">&#39;country_name&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&#34;Total&#34;</span><span class="p">)]</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">malaysia_emissions_df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="s1">&#39;country_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;mean&#39;</span>
<span class="n">malaysia_emissions_df</span>
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<h3 id="calculate-means-and-totals-across-rows">Calculate Means and Totals Across Rows<a href="#calculate-means-and-totals-across-rows" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">malaysia_emissions_df</span><span class="p">[</span><span class="s2">&#34;Mean_CH4&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean_series</span>
<span class="n">malaysia_emissions_df</span><span class="p">[</span><span class="s1">&#39;Total_CH4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">total_series</span> 
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1">## the select np.number is uncecessary, but i&#39;m including anyways as it doesnt really hurt but for a small calculation penalty</span>
<span class="n">malaysia_emissions_df</span><span class="p">[</span><span class="s2">&#34;Mean_CO2&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean_series</span>
<span class="n">malaysia_emissions_df</span><span class="p">[</span><span class="s1">&#39;Total_CO2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">total_series</span> 
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">malaysia_emissions_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">malaysia_emissions_df</span>
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<h3 id="write-data-to-file">Write Data to File<a href="#write-data-to-file" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">outfile</span> <span class="o">=</span> <span class="s2">&#34;/Users/jnapolitano/Projects/wattime-takehome/wattime-takehome/data/TRACE_DATA.csv&#34;</span>

<span class="n">malaysia_emissions_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span>
</code></pre></div><h2 id="university-of-malaysia-plots">University of Malaysia Plots<a href="#university-of-malaysia-plots" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<h3 id="university-of-malaysia-bar-plot">University of Malaysia Bar Plot<a href="#university-of-malaysia-bar-plot" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">malaysia_emissions_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s2">&#34;barh&#34;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;country_name&#39;</span><span class="p">,</span> <span class="n">xlabel</span> <span class="o">=</span> <span class="s2">&#34;Country Name&#34;</span><span class="p">,</span> <span class="n">ylabel</span> <span class="o">=</span> <span class="s2">&#34;CH4 Tonnes&#34;</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
</code></pre></div><pre><code>&lt;AxesSubplot:ylabel='Country Name'&gt;
</code></pre>
<p><img src="data_exploration_files/data_exploration_28_1.png" alt="png"></p>
<h3 id="university-of-malaysia-density-plot">University of Malaysia Density Plot<a href="#university-of-malaysia-density-plot" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">malaysia_emissions_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rot</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s2">&#34;density&#34;</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span> 
</code></pre></div><pre><code>&lt;AxesSubplot:ylabel='Density'&gt;
</code></pre>
<p><img src="data_exploration_files/data_exploration_30_1.png" alt="png"></p>
<p>I did not exclude totals or mean from the dataframe, but as we can see the second hump in the density graph shows the distribution of totals annualy.  Interestingly the 2020 data is shifted further to the right than other years.  This actually questions the validity of the study promoted by the University of malaysia</p>
<h2 id="faostat-data">FAOSTAT Data<a href="#faostat-data" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">filepath</span> <span class="o">=</span> <span class="s2">&#34;/Users/jnapolitano/Projects/wattime-takehome/wattime-takehome/data/emissions_csv_fao_emiss_csv_ch4_fao_2015_2019_tonnes.xlsx&#34;</span>

<span class="n">faostat_emissions_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
</code></pre></div><h3 id="print-faostat-data">Print FAOSTAT Data<a href="#print-faostat-data" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1">## I didn&#39;t write the index to the csv file in the previous step.  IF time permits go back and fix this error</span>
<span class="n">faostat_emissions_df</span>

</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<h3 id="change-code-to-iso3_country">Change code to iso3_country<a href="#change-code-to-iso3_country" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python">
<span class="n">faostat_emissions_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;code&#34;</span><span class="p">:</span> <span class="s2">&#34;iso3_country&#34;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">faostat_emissions_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;country&#34;</span><span class="p">:</span> <span class="s2">&#34;country_name&#34;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># The column title is not a string.  It is understood as an int or a datetime.  </span>
<span class="c1">#faostat_emissions_df[&#39;2015&#39;]</span>
<span class="n">faostat_emissions_df</span>
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<h3 id="set-country_name-total-to-total">Set country_name total to total<a href="#set-country_name-total-to-total" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">faostat_emissions_df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="mi">23</span><span class="p">,</span><span class="s1">&#39;country_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Total&#39;</span>
</code></pre></div><h3 id="drop-fao-country-code">Drop Fao Country Code<a href="#drop-fao-country-code" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">faostat_emissions_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;country_fao&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">faostat_emissions_df</span>
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<h3 id="calculate-co2-equivalency-1">Calculate Co2 Equivalency<a href="#calculate-co2-equivalency-1" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">faostat_emissions_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2015&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">faostat_emissions_df</span><span class="p">[</span><span class="mi">2015</span><span class="p">]</span> <span class="o">*</span> <span class="mi">25</span>
<span class="n">faostat_emissions_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2016&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">faostat_emissions_df</span><span class="p">[</span><span class="mi">2016</span><span class="p">]</span> <span class="o">*</span> <span class="mi">25</span>
<span class="n">faostat_emissions_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2017&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">faostat_emissions_df</span><span class="p">[</span><span class="mi">2017</span><span class="p">]</span> <span class="o">*</span> <span class="mi">25</span>
<span class="n">faostat_emissions_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2018&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">faostat_emissions_df</span><span class="p">[</span><span class="mi">2018</span><span class="p">]</span> <span class="o">*</span> <span class="mi">25</span>
<span class="n">faostat_emissions_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2019&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">faostat_emissions_df</span><span class="p">[</span><span class="mi">2019</span><span class="p">]</span> <span class="o">*</span> <span class="mi">25</span>
</code></pre></div><h3 id="calculate-means-1">Calculate Means<a href="#calculate-means-1" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">faostat_emissions_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">faostat_emissions_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">faostat_emissions_df</span><span class="p">[</span><span class="s1">&#39;country_name&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&#34;Total&#34;</span><span class="p">)]</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">faostat_emissions_df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="s1">&#39;country_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;mean&#39;</span>
<span class="n">faostat_emissions_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#faostat_emissions_df.at[&#39;mean&#39;,&#39;country_fao&#39;] = &#39;mean&#39;</span>

</code></pre></div><h3 id="calculate-means-and-totals-across-rows-1">Calculate Means and Totals Across Rows<a href="#calculate-means-and-totals-across-rows-1" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">faostat_emissions_df</span><span class="p">[</span><span class="s2">&#34;Mean_CH4&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean_series</span>
<span class="n">faostat_emissions_df</span><span class="p">[</span><span class="s1">&#39;Total_CH4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">total_series</span> 
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1">## the select np.number is uncecessary, but i&#39;m including anyways as it doesnt really hurt but for a small calculation penalty</span>
<span class="n">faostat_emissions_df</span><span class="p">[</span><span class="s2">&#34;Mean_CO2&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean_series</span>
<span class="n">faostat_emissions_df</span><span class="p">[</span><span class="s1">&#39;Total_CO2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">total_series</span> 
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">faostat_emissions_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">faostat_emissions_df</span>
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<h3 id="faostat-data-to-file">FAOSTAT Data to File<a href="#faostat-data-to-file" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">outfile</span> <span class="o">=</span> <span class="s2">&#34;/Users/jnapolitano/Projects/wattime-takehome/wattime-takehome/data/FAOSTAT_DATA.csv&#34;</span>

<span class="n">faostat_emissions_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span>
</code></pre></div><h2 id="faostat-plots">FaoSTAT PLOTS<a href="#faostat-plots" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<h3 id="faostat-hectare-estimates-bar-plot">FAOSTAT Hectare Estimates Bar Plot<a href="#faostat-hectare-estimates-bar-plot" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">faostat_emissions_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s2">&#34;barh&#34;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;country_name&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">2016</span><span class="p">,</span> <span class="mi">2017</span><span class="p">,</span> <span class="mi">2018</span><span class="p">,</span> <span class="mi">2019</span><span class="p">],</span> <span class="n">xlabel</span> <span class="o">=</span> <span class="s2">&#34;Country Name&#34;</span><span class="p">,</span> <span class="n">ylabel</span> <span class="o">=</span> <span class="s2">&#34;Tonnes CH4&#34;</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
</code></pre></div><pre><code>&lt;AxesSubplot:ylabel='Country Name'&gt;
</code></pre>
<p><img src="data_exploration_files/data_exploration_55_1.png" alt="png"></p>
<h3 id="faostat-density-plot">FAOSTAT Density Plot<a href="#faostat-density-plot" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">faostat_emissions_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rot</span> <span class="o">=</span> <span class="mi">90</span><span class="p">,</span> <span class="n">kind</span> <span class="o">=</span> <span class="s2">&#34;density&#34;</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">2016</span><span class="p">,</span> <span class="mi">2017</span><span class="p">,</span> <span class="mi">2018</span><span class="p">,</span> <span class="mi">2019</span><span class="p">],</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span> 
</code></pre></div><pre><code>&lt;AxesSubplot:ylabel='Density'&gt;
</code></pre>
<p><img src="data_exploration_files/data_exploration_57_1.png" alt="png"></p>
<p>The density plot is fairly consistent.  There is nearly no variation between nations and in total.  The 2020 data may show otherwise as the Malaysian data shows.</p>
<h2 id="join-dfs-by-iso3-country">Join Df&rsquo;s by ISO3 Country<a href="#join-dfs-by-iso3-country" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<h3 id="drop-totals-and-means-from-the-original-df">Drop totals and means from the original df.<a href="#drop-totals-and-means-from-the-original-df" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<p>Because I am joining on iso3 country country code if the totals and means are located at different indexes we may experience merge and calculation errors</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">faostat_emissions_df</span> <span class="o">=</span> <span class="n">faostat_emissions_df</span><span class="p">[(</span><span class="n">faostat_emissions_df</span><span class="p">[</span><span class="s2">&#34;country_name&#34;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&#34;Total&#34;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">faostat_emissions_df</span><span class="p">[</span><span class="s1">&#39;country_name&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;mean&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">malaysia_emissions_df</span> <span class="o">=</span> <span class="n">malaysia_emissions_df</span><span class="p">[(</span><span class="n">malaysia_emissions_df</span><span class="p">[</span><span class="s2">&#34;country_name&#34;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&#34;Total&#34;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">malaysia_emissions_df</span><span class="p">[</span><span class="s1">&#39;country_name&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;mean&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">faostat_emissions_df</span>
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">malaysia_emissions_df</span>
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">merged_df</span> <span class="o">=</span> <span class="n">faostat_emissions_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">malaysia_emissions_df</span><span class="p">,</span><span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;_FAOSTAT&#39;</span><span class="p">,</span> <span class="s1">&#39;_TRACE&#39;</span><span class="p">),</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;iso3_country&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div><h3 id="dropping-2020-and-2021-from-the-data-sets">Dropping 2020 and 2021 from the data sets<a href="#dropping-2020-and-2021-from-the-data-sets" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<p>I will only compare data compiled from the same year.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">merged_df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">2021</span><span class="p">,</span> <span class="s2">&#34;tCH4_2020&#34;</span><span class="p">,</span><span class="s2">&#34;tCH4_2021&#34;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">merged_df</span>
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<h3 id="calculate-difference-in-ch4-tonnes-between-the-estimates">Calculate difference in Ch4 Tonnes Between the Estimates<a href="#calculate-difference-in-ch4-tonnes-between-the-estimates" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Calculate Difference in tons</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CH4_diff_2015&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="mi">2015</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCH4_2015&#39;</span><span class="p">]</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CH4_diff_2016&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="mi">2016</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCH4_2016&#39;</span><span class="p">]</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CH4_diff_2017&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="mi">2017</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCH4_2017&#39;</span><span class="p">]</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CH4_diff_2018&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="mi">2018</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCH4_2018&#39;</span><span class="p">]</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CH4_diff_2019&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="mi">2019</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCH4_2019&#39;</span><span class="p">]</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CH4_diff_means&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Mean_CH4_FAOSTAT&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Mean_CH4_TRACE&#39;</span><span class="p">]</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CH4_diff_totals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Total_CH4_FAOSTAT&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Total_CH4_TRACE&#39;</span><span class="p">]</span>


</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">merged_df</span>
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<h3 id="calculate-difference-in-c02-tonnes-between-the-estimates">Calculate difference in C02 Tonnes Between the Estimates<a href="#calculate-difference-in-c02-tonnes-between-the-estimates" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># Calculate Difference in tons</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CO2_diff_2015&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2015_FAOSTAT&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2015_TRACE&#39;</span><span class="p">]</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CO2_diff_2016&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2016_FAOSTAT&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2016_TRACE&#39;</span><span class="p">]</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CO2_diff_2017&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2017_FAOSTAT&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2017_TRACE&#39;</span><span class="p">]</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CO2_diff_2018&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2018_FAOSTAT&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2018_TRACE&#39;</span><span class="p">]</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CO2_diff_2019&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2019_FAOSTAT&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2019_TRACE&#39;</span><span class="p">]</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CO2_diff_means&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Mean_CO2_FAOSTAT&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Mean_CO2_TRACE&#39;</span><span class="p">]</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CO2_diff_totals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Total_CO2_FAOSTAT&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Total_CO2_TRACE&#39;</span><span class="p">]</span>


</code></pre></div><h3 id="calculating-the-ch4-percent-differences-between-the-estimates">Calculating the CH4 Percent Differences Between the Estimates<a href="#calculating-the-ch4-percent-differences-between-the-estimates" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1">## Calculate Percent Differnces on this data set )*100</span>
<span class="c1"># With raw data i could have accomplished this with a groupby.aggregate(lambda x ), however the pivot tables given are not easy to apply #vectorized functions across time series</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CH4_abs_percent_diff_2015&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">merged_df</span><span class="p">[</span><span class="mi">2015</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCH4_2015&#39;</span><span class="p">]))</span><span class="o">/</span><span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="mi">2015</span><span class="p">]</span> <span class="o">+</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCH4_2015&#39;</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CH4_abs_percent_diff_2016&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="nb">abs</span><span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="mi">2016</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCH4_2016&#39;</span><span class="p">]))</span><span class="o">/</span><span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="mi">2016</span><span class="p">]</span> <span class="o">+</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCH4_2016&#39;</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span><span class="o">*</span><span class="mi">100</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CH4_abs_percent_diff_2017&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">merged_df</span><span class="p">[</span><span class="mi">2017</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCH4_2017&#39;</span><span class="p">]))</span><span class="o">/</span><span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="mi">2017</span><span class="p">]</span> <span class="o">+</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCH4_2017&#39;</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CH4_abs_percent_diff_2018&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">abs</span><span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="mi">2018</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCH4_2018&#39;</span><span class="p">]))</span><span class="o">/</span><span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="mi">2018</span><span class="p">]</span> <span class="o">+</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCH4_2018&#39;</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CH4_abs_percent_diff_2019&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">abs</span><span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="mi">2019</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCH4_2019&#39;</span><span class="p">]))</span><span class="o">/</span><span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="mi">2019</span><span class="p">]</span> <span class="o">+</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCH4_2019&#39;</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CH4_abs_percent_diff_means&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">abs</span><span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Mean_CH4_FAOSTAT&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Mean_CH4_TRACE&#39;</span><span class="p">]))</span><span class="o">/</span><span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Mean_CH4_FAOSTAT&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Mean_CH4_TRACE&#39;</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span> <span class="mi">100</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CH4_abs_percent_diff_totals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">abs</span><span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Total_CH4_FAOSTAT&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Total_CH4_TRACE&#39;</span><span class="p">]))</span><span class="o">/</span><span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Total_CH4_TRACE&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Total_CH4_FAOSTAT&#39;</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span>


<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CH4_relative_percent_diff_2015&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="mi">2015</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCH4_2015&#39;</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">merged_df</span><span class="p">[</span><span class="mi">2015</span><span class="p">]))</span><span class="o">*</span><span class="mi">100</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CH4_relative_percent_diff_2016&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="mi">2016</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCH4_2016&#39;</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">merged_df</span><span class="p">[</span><span class="mi">2016</span><span class="p">]))</span><span class="o">*</span><span class="mi">100</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CH4_relative_percent_diff_2017&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="mi">2017</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCH4_2017&#39;</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">merged_df</span><span class="p">[</span><span class="mi">2017</span><span class="p">]))</span><span class="o">*</span><span class="mi">100</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CH4_relative_percent_diff_2018&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="mi">2018</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCH4_2018&#39;</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">merged_df</span><span class="p">[</span><span class="mi">2018</span><span class="p">]))</span><span class="o">*</span><span class="mi">100</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CH4_relative_percent_diff_2019&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="mi">2019</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCH4_2019&#39;</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">merged_df</span><span class="p">[</span><span class="mi">2019</span><span class="p">]))</span><span class="o">*</span><span class="mi">100</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CH4_relative_percent_diff_means&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Mean_CH4_FAOSTAT&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Mean_CH4_TRACE&#39;</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">merged_df</span><span class="p">[</span><span class="s2">&#34;Mean_CH4_FAOSTAT&#34;</span><span class="p">]))</span><span class="o">*</span><span class="mi">100</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CH4_relative_percent_diff_totals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Total_CH4_FAOSTAT&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Total_CH4_TRACE&#39;</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">merged_df</span><span class="p">[</span><span class="s2">&#34;Total_CH4_FAOSTAT&#34;</span><span class="p">]))</span><span class="o">*</span><span class="mi">100</span>

</code></pre></div><h3 id="calculate-co2-differences">Calculate CO2 Differences<a href="#calculate-co2-differences" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1">## Calculate Percent Differnces on this data set )*100</span>
<span class="c1"># With raw data i could have accomplished this with a groupby.aggregate(lambda x ), however the pivot tables given are not easy to apply #vectorized functions across time series</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CO2_abs_percent_diff_2015&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="nb">abs</span><span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2015_FAOSTAT&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2015_TRACE&#39;</span><span class="p">]))</span><span class="o">/</span><span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2015_TRACE&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2015_FAOSTAT&#39;</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CO2_abs_percent_diff_2016&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2016_FAOSTAT&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2016_TRACE&#39;</span><span class="p">]))</span><span class="o">/</span><span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2016_TRACE&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2016_FAOSTAT&#39;</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CO2_abs_percent_diff_2017&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2017_FAOSTAT&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2017_TRACE&#39;</span><span class="p">]))</span><span class="o">/</span><span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2017_TRACE&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2017_FAOSTAT&#39;</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CO2_abs_percent_diff_2018&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2018_FAOSTAT&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2018_TRACE&#39;</span><span class="p">]))</span><span class="o">/</span><span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2018_TRACE&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2018_FAOSTAT&#39;</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CO2_abs_percent_diff_2019&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2019_FAOSTAT&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2019_TRACE&#39;</span><span class="p">]))</span><span class="o">/</span><span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2019_TRACE&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2019_FAOSTAT&#39;</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CO2_abs_percent_diff_means&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Mean_CO2_FAOSTAT&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Mean_CO2_TRACE&#39;</span><span class="p">]))</span><span class="o">/</span><span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Mean_CO2_FAOSTAT&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Mean_CO2_TRACE&#39;</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span> <span class="mi">100</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CO2_abs_percent_diff_totals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Total_CO2_FAOSTAT&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Total_CO2_TRACE&#39;</span><span class="p">]))</span><span class="o">/</span><span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Total_CO2_TRACE&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Total_CO2_FAOSTAT&#39;</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span>


<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CO2_relative_percent_diff_2015&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2015_FAOSTAT&#39;</span><span class="p">]</span>  <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2015_TRACE&#39;</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2015_FAOSTAT&#39;</span><span class="p">]))</span><span class="o">*</span><span class="mi">100</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CO2_relative_percent_diff_2016&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2016_FAOSTAT&#39;</span><span class="p">]</span>  <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2016_TRACE&#39;</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2016_FAOSTAT&#39;</span><span class="p">]))</span><span class="o">*</span><span class="mi">100</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CO2_relative_percent_diff_2017&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2017_FAOSTAT&#39;</span><span class="p">]</span>  <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2017_TRACE&#39;</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2017_FAOSTAT&#39;</span><span class="p">]))</span><span class="o">*</span><span class="mi">100</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CO2_relative_percent_diff_2018&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2018_FAOSTAT&#39;</span><span class="p">]</span>  <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2018_TRACE&#39;</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2018_FAOSTAT&#39;</span><span class="p">]))</span><span class="o">*</span><span class="mi">100</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CO2_relative_percent_diff_2019&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2019_FAOSTAT&#39;</span><span class="p">]</span>  <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2019_TRACE&#39;</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;tCO2_2019_FAOSTAT&#39;</span><span class="p">]))</span><span class="o">*</span><span class="mi">100</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CO2_relative_percent_diff_means&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="s2">&#34;Mean_CO2_FAOSTAT&#34;</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Mean_CO2_TRACE&#39;</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">merged_df</span><span class="p">[</span><span class="s2">&#34;Mean_CO2_FAOSTAT&#34;</span><span class="p">]))</span><span class="o">*</span><span class="mi">100</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;CO2_relative_percent_diff_totals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Total_CO2_FAOSTAT&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;Total_CO2_TRACE&#39;</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">merged_df</span><span class="p">[</span><span class="s2">&#34;Total_CO2_FAOSTAT&#34;</span><span class="p">]))</span><span class="o">*</span><span class="mi">100</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">merged_df</span>
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<h3 id="recalculate-means">Recalculate Means<a href="#recalculate-means" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">merged_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">merged_df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="s1">&#39;country_name_FAOSTAT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;mean&#39;</span>
<span class="n">merged_df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span><span class="s1">&#39;country_name_TRACE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;mean&#39;</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">merged_df</span>
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<h3 id="recalculate-totals">Recalculate Totals<a href="#recalculate-totals" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">merged_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;total&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;country_name_FAOSTAT&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">merged_df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;total&#39;</span><span class="p">,</span><span class="s1">&#39;country_name_FAOSTAT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;total&#39;</span>
<span class="n">merged_df</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="s1">&#39;total&#39;</span><span class="p">,</span><span class="s1">&#39;country_name_TRACE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;total&#39;</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">merged_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">merged_df</span>
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<h3 id="merged-data-to-file">Merged Data to File<a href="#merged-data-to-file" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">outfile</span> <span class="o">=</span> <span class="s2">&#34;/Users/jnapolitano/Projects/wattime-takehome/wattime-takehome/data/MERGED_DATA.csv&#34;</span>

<span class="n">merged_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span>
</code></pre></div><h3 id="co2-difference-plots">CO2 Difference Plots<a href="#co2-difference-plots" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">merged_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s2">&#34;barh&#34;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;country_name_FAOSTAT&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;CO2_diff_2015&#34;</span><span class="p">,</span> <span class="s2">&#34;CO2_diff_2016&#34;</span><span class="p">,</span>	<span class="s2">&#34;CO2_diff_2017&#34;</span><span class="p">,</span> <span class="s2">&#34;CO2_diff_2018&#34;</span><span class="p">,</span> <span class="s2">&#34;CO2_diff_2019&#34;</span><span class="p">],</span> <span class="n">xlabel</span> <span class="o">=</span> <span class="s2">&#34;Country Name&#34;</span><span class="p">,</span> <span class="n">ylabel</span> <span class="o">=</span> <span class="s2">&#34;Tonnes CH4&#34;</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
</code></pre></div><pre><code>&lt;AxesSubplot:ylabel='Country Name'&gt;
</code></pre>
<p><img src="data_exploration_files/data_exploration_92_1.png" alt="png"></p>
<h3 id="percent-difference-plot">Percent Difference Plot<a href="#percent-difference-plot" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">merged_df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span> <span class="o">=</span> <span class="s2">&#34;barh&#34;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;country_name_FAOSTAT&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;CO2_relative_percent_diff_2015&#34;</span><span class="p">,</span> <span class="s2">&#34;CO2_relative_percent_diff_2016&#34;</span><span class="p">,</span>	<span class="s2">&#34;CO2_relative_percent_diff_2017&#34;</span><span class="p">,</span> <span class="s2">&#34;CO2_relative_percent_diff_2018&#34;</span><span class="p">,</span> <span class="s2">&#34;CO2_relative_percent_diff_2019&#34;</span><span class="p">],</span> <span class="n">xlabel</span> <span class="o">=</span> <span class="s2">&#34;Country Name&#34;</span><span class="p">,</span> <span class="n">ylabel</span> <span class="o">=</span> <span class="s2">&#34;Tonnes CH4&#34;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
</code></pre></div><pre><code>&lt;AxesSubplot:ylabel='Country Name'&gt;
</code></pre>
<p><img src="data_exploration_files/data_exploration_94_1.png" alt="png"></p>

			</div>

		</article>
		<div class="post-nav thin">
			<a class="next-post" href="jnapolitano.com/posts/legal-research-part-5/">
				<span class="post-nav-label"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>&nbsp;</span><br><span>Conduct Legal Research with AI: Part 5</span>
			</a>
			<a class="prev-post" href="jnapolitano.com/posts/legal-research-part-4/">
				<span class="post-nav-label">&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg></span><br><span>Conduct Legal Research with AI: Part 4</span>
			</a>
		</div>
		<div id="comments" class="thin"></div>
	</main>

<footer id="site-footer" class="section-inner thin animated fadeIn faster">
	<p>
		&copy; 2024 <a href="jnapolitano.com">Justin Napolitano</a>
		&#183; JAYBURDINDUSTRIES
		&#183; Made with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a>
		&#183; Theme <a href="https://github.com/1bl4z3r/hermit-V2" target="_blank" rel="noopener">Hermit-V2</a></p>

</footer>
<script async src="/jnapolitano.com/js/bundle.min.5034a061023fdc1bbf821910f95d3bda81bc68ba039a2c1202f0d7027638e80f.js" integrity="sha256-UDSgYQI/3Bu/ghkQ+V072oG8aLoDmiwSAvDXAnY46A8=" crossorigin="anonymous"></script><script async src="/jnapolitano.com/js/link-share.min.20ddc5b895a2cb52c811efd9bcf38168838be5cb8671b12ae2997bf38c34f9f0.js" integrity="sha256-IN3FuJWiy1LIEe/ZvPOBaIOL5cuGcbEq4pl784w0+fA=" crossorigin="anonymous"></script>
</body>

</html>
